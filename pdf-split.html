<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <!-- ===== ADVANCED SEO FOR PDF SPLIT ===== -->
    <title>Split PDF Online Free | Extract PDF Pages - PDFSmartCore</title>
  
    <meta name="description" content="Split PDF pages into separate files online. Extract pages from PDF for free. No watermarks, secure, works locally in browser. Organize PDF pages easily.">
  
    <meta name="keywords" content="
        split pdf, split pdf online, extract pdf pages, separate pdf, pdf splitter,
        pdf pages extractor, divide pdf, split pdf file, pdf page extractor,
        extract pages from pdf, split pdf document, pdf organizer, pdf page splitter,
        online pdf splitter, free pdf splitter, pdf page separator, secure pdf splitter
    ">
  
    <meta name="author" content="PDFSmartCore">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  
    <!-- Canonical URL -->
    <link rel="canonical" href="https://pdfsmartcore.com/pdf-split.html">
  
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Split PDF Online Free - Extract PDF Pages">
    <meta property="og:description" content="Split PDF pages into separate files. 100% free, secure, works locally in browser.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pdfsmartcore.com/pdf-split.html">
    <meta property="og:image" content="https://pdfsmartcore.com/pdf-split-og.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="PDFSmartCore">
  
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Split PDF Online Free - Extract Pages">
    <meta name="twitter:description" content="Split PDF into separate pages. 100% free, no registration required.">
    <meta name="twitter:image" content="https://pdfsmartcore.com/pdf-split-twitter.png">
  
    <!-- Structured Data for Google -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "PDF Split Tool",
      "url": "https://pdfsmartcore.com/pdf-split.html",
      "description": "Free online tool to split PDF files and extract pages",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Split PDF into separate pages",
        "Extract specific pages",
        "Rearrange PDF pages",
        "Drag and drop interface",
        "Local processing (no uploads)",
        "No file size limits"
      ],
      "applicationSubCategory": "PDF Software",
      "screenshot": "https://pdfsmartcore.com/screenshot.png",
      "softwareVersion": "2.0",
      "releaseNotes": "Local PDF splitting with page extraction and rearrangement"
    }
    </script>
  
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Is PDF splitting really free?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, our PDF split tool is 100% free with no hidden charges, no watermarks, and no usage limits."
          }
        },
        {
          "@type": "Question",
          "name": "Can I extract specific pages from PDF?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, you can select and extract specific pages from your PDF document."
          }
        },
        {
          "@type": "Question",
          "name": "Are my PDF files uploaded to any server?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, all splitting happens locally in your browser. Your PDF files never leave your computer."
          }
        },
        {
          "@type": "Question",
          "name": "Can I rearrange pages before splitting?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, you can drag and drop pages to rearrange them in any order."
          }
        }
      ]
    }
    </script>
  
    <!-- CDN Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
    <style>
        /* (Yeh style section bilkul same rakha hai, koi change nahi) */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --primary-glow: rgba(99, 102, 241, 0.15);
            --success: #10b981;
            --success-dark: #0da271;
            --success-glow: rgba(16, 185, 129, 0.15);
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --warning: #f59e0b;
            --warning-glow: rgba(245, 158, 11, 0.15);
            --info: #3b82f6;
            --info-glow: rgba(59, 130, 246, 0.15);
            --sidebar: #0f172a;
            --sidebar-light: #1e293b;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 40px -15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --radius: 14px;
            --radius-sm: 8px;
            --radius-lg: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        body {
            background: var(--bg);
            color: var(--text-primary);
            display: flex;
            height: 100vh;
            overflow: hidden;
            font-weight: 400;
            line-height: 1.6;
        }
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--sidebar);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: var(--transition);
        }
        .mobile-menu-btn:hover {
            background: var(--primary);
            transform: scale(1.05);
        }
        .sidebar {
            width: 280px;
            background: var(--sidebar);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
            z-index: 100;
        }
        .logo {
            padding: 24px 20px;
            font-size: 1.6rem;
            font-weight: 800;
            color: #ffffff;
            border-bottom: 1px solid var(--sidebar-light);
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-fill-color: transparent;
        }
        .logo i {
            font-size: 1.8rem;
            color: #ff6b6b;
            filter: drop-shadow(0 2px 4px rgba(255, 107, 107, 0.3));
            transition: var(--transition);
        }
        .nav-group {
            padding: 20px 0;
            flex: 1;
        }
        .nav-item {
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 14px;
            color: var(--text-light);
            transition: var(--transition);
            font-size: 0.95rem;
            font-weight: 500;
            margin: 4px 12px;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            text-decoration: none;
        }
        .nav-item:hover {
            background: var(--sidebar-light);
            color: white;
            transform: translateX(4px);
        }
        .nav-item.active {
            background: linear-gradient(135deg, var(--sidebar-light), rgba(99, 102, 241, 0.1));
            color: white;
            border-left: 4px solid var(--primary);
            font-weight: 600;
        }
        .nav-item i {
            width: 24px;
            text-align: center;
            font-size: 1.4rem;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: var(--transition);
        }
        .nav-item:hover i {
            background: linear-gradient(135deg, #4ade80, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .nav-item.active i {
            background: linear-gradient(135deg, #4ade80, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 8px rgba(74, 222, 128, 0.5));
        }
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }
        .mobile-overlay.active {
            display: block;
        }
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            padding: 0;
            position: relative;
        }
        .tool-box {
            display: flex;
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            flex: 1;
            overflow: hidden;
            border: 1px solid var(--border);
            margin: 20px;
            position: relative;
            min-height: calc(100vh - 40px);
            flex-direction: column;
        }
        .tool-page-header {
            text-align: center;
            padding: 25px 30px 15px 30px;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, #f9fafb, #f1f5f9);
        }
        .tool-page-header h1 {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-fill-color: transparent;
            text-shadow: 0 4px 10px rgba(255, 107, 107, 0.15);
        }
        .tool-page-header p {
            font-size: 0.95rem;
            color: #4a5568;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.5;
            font-weight: 500;
        }
        .tool-workspace {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .editor-side {
            flex: 1.2;
            padding: 25px;
            background: linear-gradient(135deg, #f9fafb, #f1f5f9);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            position: relative;
        }
        .result-side {
            flex: 1;
            padding: 25px;
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
            position: relative;
        }
        .editor-side::-webkit-scrollbar {
            width: 8px;
        }
        .editor-side::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .editor-side::-webkit-scrollbar-thumb {
            background: #ff6b6b;
            border-radius: 10px;
            min-height: 40px;
        }
        .editor-side::-webkit-scrollbar-thumb:hover {
            background: #ff5252;
        }
        .back-btn {
            background: rgba(255, 107, 107, 0.1);
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        .back-btn:hover {
            background: rgba(255, 107, 107, 0.2);
            transform: translateX(-4px);
        }
        .help-btn {
            background: rgba(59, 130, 246, 0.1);
            border: none;
            color: #3b82f6;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 15px;
            margin-left: 10px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        .help-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }
        .tool-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 5px;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-fill-color: transparent;
        }
        .tool-subtitle {
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 20px;
            font-weight: 500;
        }
        #upload-zone {
            border: 3px dashed var(--border);
            padding: 40px 30px;
            text-align: center;
            border-radius: var(--radius);
            cursor: pointer;
            background: var(--card-bg);
            transition: var(--transition);
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        #upload-zone:hover {
            border-color: #ffa726;
            background: rgba(255, 167, 38, 0.02);
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }
        #upload-zone i {
            font-size: 3rem;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            filter: drop-shadow(0 4px 6px rgba(255, 107, 107, 0.2));
            transition: var(--transition);
        }
        #upload-zone:hover i {
            transform: scale(1.1);
            background: linear-gradient(135deg, #4ade80, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        #upload-zone h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 6px;
        }
        #upload-zone p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 3px;
        }
        .upload-hint {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 10px;
        }
        .page-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }
        .page-grid::-webkit-scrollbar {
            width: 10px;
        }
        .page-grid::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .page-grid::-webkit-scrollbar-thumb {
            background: #ff6b6b;
            border-radius: 10px;
            min-height: 50px;
        }
        .page-grid::-webkit-scrollbar-thumb:hover {
            background: #ff5252;
        }
        .page-item {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px 8px 8px 8px;
            position: relative;
            text-align: center;
            transition: var(--transition);
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            min-height: 160px;
            cursor: default;
        }
        .page-item:hover {
            border-color: #ff6b6b;
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }
        .page-item img {
            width: 100%;
            border-radius: 6px;
            display: block;
            aspect-ratio: 3/4;
            object-fit: cover;
            background: #f8fafc;
            pointer-events: none;
        }
        .drag-handle {
            position: absolute;
            top: 6px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-secondary);
            font-size: 1.1rem;
            cursor: move;
            z-index: 5;
            padding: 5px;
            background: rgba(255,255,255,0.9);
            border-radius: 4px;
            width: 32px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            touch-action: none;
        }
        .drag-handle i {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .page-number {
            position: absolute;
            top: 32px;
            left: 6px;
            background: rgba(255, 107, 107, 0.9);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            pointer-events: none;
        }
        .page-ctrl {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            justify-content: center;
            position: relative;
            z-index: 10;
        }
        .c-btn {
            border: none;
            padding: 10px 12px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 700;
            transition: var(--transition);
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            min-height: 36px;
            -webkit-tap-highlight-color: rgba(0,0,0,0);
            touch-action: manipulation;
            position: relative;
            z-index: 100;
            pointer-events: auto !important;
        }
        .c-btn * {
            pointer-events: none;
        }
        .c-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .btn-del {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
        }
        .btn-del:hover {
            background: linear-gradient(135deg, #ff5252, #ff4444);
        }
        .btn-add {
            background: linear-gradient(135deg, #4ade80, #22c55e);
        }
        .btn-add:hover {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }
        .btn-main {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: var(--radius-sm);
            font-weight: 700;
            width: 100%;
            cursor: pointer;
            margin-top: 20px;
            transition: var(--transition);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            letter-spacing: 0.5px;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .btn-main:hover {
            background: linear-gradient(135deg, #ffa726, #ff6b6b);
            transform: translateY(-4px);
            box-shadow: 0 15px 30px rgba(255, 107, 107, 0.3);
        }
        .btn-success {
            background: linear-gradient(135deg, #4ade80, #22c55e);
        }
        .btn-outline {
            background: white;
            color: #ff6b6b;
            border: 2px solid #ff6b6b;
            padding: 16px 25px;
            border-radius: var(--radius-sm);
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 12px;
            transition: var(--transition);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .btn-outline:hover {
            background: rgba(255, 107, 107, 0.05);
            transform: translateY(-3px);
        }
        #status-label {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding: 14px;
            background: rgba(255, 107, 107, 0.05);
            border-radius: var(--radius-sm);
            border-left: 4px solid #ff6b6b;
        }
        .loader {
            display: none;
            width: 45px;
            height: 45px;
            border: 4px solid rgba(255, 107, 107, 0.1);
            border-top: 4px solid #ff6b6b;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        #preview-frame {
            width: 100%;
            height: 500px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            display: none;
            margin-top: 15px;
            box-shadow: var(--shadow);
            background: white;
        }
        #success-btns {
            display: none;
            width: 100%;
            margin-top: 20px;
        }
        .hidden {
            display: none !important;
        }
        .how-to-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .popup-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 30px;
            box-shadow: var(--shadow-xl);
            position: relative;
            border: 1px solid var(--border);
        }
        .popup-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(239, 68, 68, 0.1);
            border: none;
            color: #ef4444;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
        }
        .popup-close:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: rotate(90deg);
        }
        .popup-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-fill-color: transparent;
        }
        .popup-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
            font-weight: 500;
        }
        .instructions-list {
            list-style: none;
            padding-left: 0;
        }
        .instructions-list li {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-primary);
            display: flex;
            align-items: flex-start;
            gap: 12px;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        .instructions-list li:last-child {
            border-bottom: none;
        }
        .instructions-list li i {
            background: linear-gradient(135deg, #4ade80, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.1rem;
            margin-top: 2px;
            flex-shrink: 0;
        }
        .note-box {
            background: rgba(255, 167, 38, 0.1);
            border-left: 4px solid #ffa726;
            padding: 16px;
            border-radius: var(--radius-sm);
            margin-top: 25px;
        }
        .note-box p {
            color: #7c2d12;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 8px;
        }
        .note-box i {
            color: #ffa726;
            margin-right: 8px;
        }
        .sortable-ghost {
            opacity: 0.4;
            background: rgba(99, 102, 241, 0.1);
        }
        .sortable-chosen {
            background: rgba(255, 167, 38, 0.1);
            border-color: #ffa726;
        }
        .sortable-drag {
            opacity: 0.8;
            transform: rotate(3deg);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .footer-section {
            width: 100%;
            padding: 40px 24px 30px 24px;
            background: var(--card-bg);
            border-top: 1px solid var(--border);
            margin-top: auto;
            position: relative;
            z-index: 5;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .footer-second-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 40px;
            margin-top: 40px;
            max-width: 1400px;
            margin: 40px auto 0 auto;
        }
        .privacy-box, .copyright-box, .about-box, .contact-box {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            height: 100%;
        }
        .about-box, .contact-box {
            padding: 25px;
        }
        .privacy-box:hover, .copyright-box:hover, .about-box:hover, .contact-box:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .about-box .section-title, .contact-box .section-title {
            font-size: 1.2rem;
        }
        .section-title i {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .privacy-content ul, .copyright-content ul, .about-content p, .contact-content p {
            list-style: none;
            padding-left: 0;
        }
        .privacy-content li, .copyright-content li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        .privacy-content li:last-child, .copyright-content li:last-child {
            border-bottom: none;
        }
        .privacy-content li i, .copyright-content li i {
            color: var(--success);
            font-size: 0.9rem;
            background: linear-gradient(135deg, #4ade80, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            flex-shrink: 0;
        }
        .about-content p, .contact-content p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        .made-with-love {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 600;
        }
        .made-with-love i {
            color: #ff6b6b;
            margin: 0 5px;
            animation: heartbeat 1.5s infinite;
        }
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        @media (max-width: 1200px) {
            .sidebar {
                width: 240px;
            }
        }
        @media (max-width: 992px) {
            .mobile-menu-btn {
                display: flex;
            }
            body {
                flex-direction: column;
                height: auto;
                min-height: 100vh;
                overflow-y: auto;
            }
            .sidebar {
                width: 280px;
                height: 100vh;
                position: fixed;
                top: 0;
                left: -280px;
                z-index: 100;
                transition: left 0.3s ease;
                box-shadow: 3px 0 15px rgba(0, 0, 0, 0.15);
            }
            .sidebar.show {
                left: 0;
            }
            .logo {
                padding: 20px;
                font-size: 1.5rem;
                justify-content: center;
            }
            .nav-group {
                display: flex;
                flex-direction: column;
                padding: 15px 0;
            }
            .nav-item {
                margin: 5px 15px;
                padding: 14px 20px;
            }
            .content {
                margin-top: 0;
                padding-top: 80px;
                height: calc(100vh - 80px);
            }
            .tool-box {
                margin: 10px;
                min-height: calc(100vh - 90px);
            }
            .tool-workspace {
                flex-direction: column;
            }
            .editor-side, .result-side {
                width: 100%;
                padding: 20px;
            }
            .editor-side {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
            .footer-section {
                padding: 30px 20px;
            }
            .footer-grid, .footer-second-row {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            .tool-page-header h1 {
                font-size: 1.8rem;
            }
            #upload-zone {
                padding: 30px 20px;
                margin: 20px 0;
            }
            #upload-zone i {
                font-size: 2.5rem;
            }
            #upload-zone h3 {
                font-size: 1.2rem;
            }
            #preview-frame {
                height: 400px;
            }
            .page-grid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            }
            .page-number {
                top: 30px;
            }
        }
        @media (max-width: 768px) {
            .editor-side, .result-side {
                padding: 15px;
            }
            .tool-title {
                font-size: 1.4rem;
            }
            .tool-page-header {
                padding: 20px 15px 12px 15px;
            }
            .tool-page-header h1 {
                font-size: 1.6rem;
            }
            #upload-zone {
                padding: 25px 15px;
            }
            #upload-zone i {
                font-size: 2.2rem;
            }
            .page-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 12px;
                max-height: 250px;
            }
            .popup-content {
                padding: 20px;
            }
            .popup-title {
                font-size: 1.5rem;
            }
            .popup-close {
                top: 15px;
                right: 15px;
            }
            .footer-section {
                padding: 25px 16px;
            }
            .privacy-box, .copyright-box, .about-box, .contact-box {
                padding: 20px;
            }
            .footer-grid, .footer-second-row {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            #preview-frame {
                height: 350px;
            }
            .c-btn {
                padding: 9px 10px;
                font-size: 0.7rem;
                min-height: 34px;
            }
            .page-number {
                top: 28px;
                width: 22px;
                height: 22px;
                font-size: 0.65rem;
            }
        }
        @media (max-width: 480px) {
            .mobile-menu-btn {
                top: 15px;
                left: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }
            .page-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .tool-page-header h1 {
                font-size: 1.5rem;
            }
            .tool-page-header p {
                font-size: 0.9rem;
            }
            .tool-title {
                font-size: 1.3rem;
            }
            .tool-subtitle {
                font-size: 0.85rem;
            }
            #upload-zone {
                padding: 20px 12px;
            }
            .btn-main {
                padding: 14px 20px;
                font-size: 0.9rem;
                min-height: 50px;
            }
            .popup-content {
                padding: 16px;
            }
            .popup-title {
                font-size: 1.3rem;
                padding-right: 40px;
            }
            .instructions-list li {
                font-size: 0.9rem;
                padding: 10px 0;
            }
            .privacy-box, .copyright-box, .about-box, .contact-box {
                padding: 16px;
            }
            .section-title {
                font-size: 1.2rem;
            }
            .privacy-content li, .copyright-content li {
                font-size: 0.9rem;
                padding: 8px 0;
            }
            .about-content p, .contact-content p {
                font-size: 0.9rem;
            }
            .made-with-love {
                font-size: 0.9rem;
            }
            #preview-frame {
                height: 300px;
            }
            .page-item {
                min-height: 150px;
                padding: 10px 6px 6px 6px;
            }
            .drag-handle {
                width: 28px;
                height: 22px;
                font-size: 1rem;
                top: 4px;
            }
            .page-number {
                top: 26px;
                width: 20px;
                height: 20px;
                font-size: 0.6rem;
            }
        }
        @media (max-width: 360px) {
            .page-grid {
                grid-template-columns: 1fr;
            }
            .sidebar {
                width: 85%;
            }
        }
    </style>
</head>
<body>
    <!-- MOBILE MENU BUTTON -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    <!-- MOBILE OVERLAY -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    <!-- SIDEBAR NAVIGATION -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="fas fa-file-pdf"></i> PDFSmartCore
        </div>
        <div class="nav-group">
            <a href="index.html" class="nav-item">
                <i class="fas fa-home"></i> Home
            </a>
            <a href="pdf-merge.html" class="nav-item">
                <i class="fas fa-layer-group"></i> Merge PDF
            </a>
            <a href="pdf-split.html" class="nav-item active">
                <i class="fas fa-cut"></i> Split & Organize
            </a>
            <a href="word-to-pdf.html" class="nav-item">
                <i class="fas fa-file-word"></i> Word to PDF
            </a>
            <a href="pdf-size.html" class="nav-item">
                <i class="fas fa-compress-arrows-alt"></i> PDF Size
            </a>
            <a href="jpg-to-pdf.html" class="nav-item">
                <i class="fas fa-image"></i> JPG to PDF
            </a>
            <a href="pdf-to-jpg.html" class="nav-item">
                <i class="fas fa-file-image"></i> PDF to JPG
            </a>
            <a href="image-size.html" class="nav-item">
                <i class="fas fa-expand-arrows-alt"></i> Image Size
            </a>
        </div>
    </div>
    <!-- MAIN CONTENT AREA -->
    <div class="content">
        <!-- TOOL WORKSPACE -->
        <div class="tool-box">
            <!-- TOOL PAGE HEADER -->
            <div class="tool-page-header">
                <h1>Professional PDF Suite</h1>
                <p>Every tool is 100% free, secure, and works locally on your device. No uploads, no limits, no watermarks.</p>
            </div>
          
            <!-- TOOL WORKSPACE CONTENT -->
            <div class="tool-workspace">
                <div class="editor-side">
                    <div style="display: flex; align-items: center;">
                        <button class="back-btn" onclick="window.location.href='index.html'">
                            <i class="fas fa-arrow-left"></i> Back to Home
                        </button>
                        <button class="help-btn" onclick="showHowToUse()">
                            <i class="fas fa-question-circle"></i> How to Use
                        </button>
                    </div>
                  
                    <h2 class="tool-title">Split & Organize PDF</h2>
                    <p class="tool-subtitle">Extract or rearrange pages from your PDF</p>
                  
                    <!-- FILE UPLOAD ZONE -->
                    <div id="upload-zone" onclick="document.getElementById('picker').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3 id="upload-title">Select PDF File</h3>
                        <p id="picker-msg">Drag & drop PDF file or click to browse</p>
                        <p class="upload-hint" id="file-type-hint">Supports PDF files only</p>
                        <input type="file" id="picker" hidden accept=".pdf" onchange="handleFiles(this.files)">
                    </div>
                  
                    <!-- PAGE THUMBNAILS GRID -->
                    <div id="page-grid" class="page-grid"></div>
                  
                    <!-- PROCESS BUTTON -->
                    <button class="btn-main" id="process-btn" onclick="startWork()" style="display:none;">
                        <span id="process-btn-text">Split PDF</span>
                        <i class="fas fa-bolt"></i>
                    </button>
                </div>
              
                <!-- RESULT SIDE -->
                <div class="result-side">
                    <h3 id="status-label">Status: Ready</h3>
                    <div class="loader" id="loader"></div>
                    <div id="pdf-preview-container" style="display: none; margin-top: 15px; text-align: center;">
                        <p style="margin-bottom: 10px; color: var(--success); font-weight: 600;">
                            <i class="fas fa-check-circle"></i> PDF Ready for Download!
                        </p>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">
                            Click "Download Result" button to save the PDF file.
                        </p>
                    </div>
                    <iframe id="preview-frame" title="Result Preview"></iframe>
                  
                    <div id="success-btns" style="display:none;">
                        <button class="btn-main btn-success" onclick="downloadFile()">
                            <i class="fas fa-download"></i> Download Result
                        </button>
                        <button class="btn-outline" onclick="startNewTask()">
                            <i class="fas fa-sync"></i> Start New Task
                        </button>
                    </div>
                </div>
            </div>
        </div>
      
        <!-- ===== FOOTER SECTION ===== -->
        <div class="footer-section">
            <!-- FIRST ROW: Privacy & Terms -->
            <div class="footer-grid">
                <div class="privacy-box">
                    <h3 class="section-title"><i class="fas fa-user-shield"></i> Privacy Policy</h3>
                    <div class="privacy-content">
                        <ul>
                            <li><i class="fas fa-check-circle"></i> <strong>100% Local Processing:</strong> All files are processed directly in your browser</li>
                            <li><i class="fas fa-check-circle"></i> <strong>No Server Uploads:</strong> Your files never leave your computer</li>
                            <li><i class="fas fa-check-circle"></i> <strong>Auto Data Deletion:</strong> Uploaded files are automatically deleted after processing</li>
                            <li><i class="fas fa-check-circle"></i> <strong>No Tracking:</strong> We don't collect any personal information or usage data</li>
                            <li><i class="fas fa-check-circle"></i> <strong>No Cookies:</strong> We don't use tracking cookies or analytics</li>
                            <li><i class="fas fa-check-circle"></i> <strong>Session Storage:</strong> Files are only stored temporarily in browser memory</li>
                        </ul>
                    </div>
                </div>
              
                <div class="copyright-box">
                    <h3 class="section-title"><i class="fas fa-copyright"></i> Copyright & Terms</h3>
                    <div class="copyright-content">
                        <ul>
                            <li><i class="fas fa-code"></i> <strong>Software:</strong> PDFSmartCore v2.0</li>
                            <li><i class="fas fa-calendar"></i> <strong>Copyright:</strong> Â© 2026 PDFSmartCore. All rights reserved.</li>
                            <li><i class="fas fa-heart"></i> <strong>Free to Use:</strong> This software is completely free for personal and commercial use</li>
                            <li><i class="fas fa-gavel"></i> <strong>Open Source:</strong> Built using open-source libraries (pdf-lib, pdf.js, jspdf)</li>
                            <li><i class="fas fa-exclamation-triangle"></i> <strong>Disclaimer:</strong> For personal use only. Not responsible for misuse.</li>
                            <li><i class="fas fa-sync-alt"></i> <strong>Updates:</strong> Regular updates and feature additions planned</li>
                        </ul>
                    </div>
                </div>
            </div>
          
            <!-- SECOND ROW: About Us & Contact Us -->
            <div class="footer-second-row">
                <div class="about-box">
                    <h3 class="section-title"><i class="fas fa-info-circle"></i> About Us</h3>
                    <div class="about-content">
                        <p>Welcome to <strong>PDFSmartCore</strong> - your all-in-one PDF solution. We're dedicated to providing 100% free, secure, and powerful PDF tools that work entirely in your browser.</p>
                        <p>Our mission is to make PDF editing accessible to everyone without compromising on security or quality.</p>
                    </div>
                </div>
              
                <div class="contact-box">
                    <h3 class="section-title"><i class="fas fa-envelope"></i> Contact Us</h3>
                    <div class="contact-content">
                        <p>We're here to help! If you have any questions, suggestions, or feedback, please feel free to reach out to us.</p>
                        <p><strong>Email:</strong> support@pdfsmartcore.com</p>
                        <p><strong>Community:</strong> Join our community for help and discussions.</p>
                    </div>
                </div>
            </div>
          
            <!-- MADE WITH LOVE SECTION -->
            <div class="made-with-love">
                Made with <i class="fas fa-heart"></i> for the Community
            </div>
        </div>
    </div>
    <!-- HOW TO USE POPUP -->
    <div id="how-to-popup" class="how-to-popup">
        <div class="popup-content">
            <button class="popup-close" onclick="closeHowToUse()">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="popup-title">How to Use PDF Split</h2>
            <p class="popup-subtitle">Step-by-step guide for splitting PDF files</p>
          
            <ul class="instructions-list">
                <li><i class="fas fa-check-circle"></i> <span><strong>Step 1:</strong> Upload a PDF file you want to split</span></li>
                <li><i class="fas fa-check-circle"></i> <span><strong>Step 2:</strong> Each page will appear as a thumbnail</span></li>
                <li><i class="fas fa-check-circle"></i> <span><strong>Step 3:</strong> Drag to rearrange pages (optional)</span></li>
                <li><i class="fas fa-check-circle"></i> <span><strong>Step 4:</strong> Click "Split PDF" to process</span></li>
                <li><i class="fas fa-check-circle"></i> <span><strong>Step 5:</strong> Download the extracted PDF file</span></li>
            </ul>
          
            <div class="note-box">
                <p><i class="fas fa-lightbulb"></i> <strong>Note:</strong> All processing happens locally in your browser. Your files are never uploaded to any server.</p>
                <p><i class="fas fa-shield-alt"></i> <strong>Security:</strong> 100% secure and private. Files are automatically deleted after processing.</p>
            </div>
        </div>
    </div>
    <!-- JAVASCRIPT -->
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
      
        // Global variables
        let currentPages = [];
        let finalBlob = null;
        let sortableInstance = null;
        let currentPDF = null;
        let originalPDFData = null;

        // trimImage function (blank space crop)
        function trimImage(img) {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;

            let top = 0, bottom = canvas.height - 1, left = 0, right = canvas.width - 1;

            outer: for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const idx = (y * canvas.width + x) * 4;
                    if (imageData[idx + 3] > 0) {
                        if (!(imageData[idx] === 255 && imageData[idx+1] === 255 && imageData[idx+2] === 255)) {
                            top = y;
                            break outer;
                        }
                    }
                }
            }

            outer: for (let y = canvas.height - 1; y >= 0; y--) {
                for (let x = 0; x < canvas.width; x++) {
                    const idx = (y * canvas.width + x) * 4;
                    if (imageData[idx + 3] > 0) {
                        if (!(imageData[idx] === 255 && imageData[idx+1] === 255 && imageData[idx+2] === 255)) {
                            bottom = y;
                            break outer;
                        }
                    }
                }
            }

            outer: for (let x = 0; x < canvas.width; x++) {
                for (let y = 0; y < canvas.height; y++) {
                    const idx = (y * canvas.width + x) * 4;
                    if (imageData[idx + 3] > 0) {
                        if (!(imageData[idx] === 255 && imageData[idx+1] === 255 && imageData[idx+2] === 255)) {
                            left = x;
                            break outer;
                        }
                    }
                }
            }

            outer: for (let x = canvas.width - 1; x >= 0; x--) {
                for (let y = 0; y < canvas.height; y++) {
                    const idx = (y * canvas.width + x) * 4;
                    if (imageData[idx + 3] > 0) {
                        if (!(imageData[idx] === 255 && imageData[idx+1] === 255 && imageData[idx+2] === 255)) {
                            right = x;
                            break outer;
                        }
                    }
                }
            }

            const trimmedWidth = right - left + 1;
            const trimmedHeight = bottom - top + 1;

            if (trimmedWidth <= 0 || trimmedHeight <= 0) return canvas;

            const trimmedCanvas = document.createElement('canvas');
            trimmedCanvas.width = trimmedWidth;
            trimmedCanvas.height = trimmedHeight;
            const trimmedCtx = trimmedCanvas.getContext('2d');
            trimmedCtx.drawImage(canvas, left, top, trimmedWidth, trimmedHeight, 0, 0, trimmedWidth, trimmedHeight);

            return trimmedCanvas;
        }

        // New function to correct EXIF orientation (for phone photos)
        async function loadImageWithOrientation(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');

                        // Default: no rotation
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);

                        // To handle EXIF orientation properly, we can use a library or simple check
                        // But for simplicity, since most phones use 6 (rotated 90Â° CW) for portrait
                        // We rotate the canvas if needed (detect by aspect ratio or assume common cases)
                        // Better: use exif-js or manual rotation for common cases
                        // Here simple heuristic: if height > width after load, but thumbnail was portrait, rotate

                        // For real fix, we need exif data
                        // Since no exif-js, we use a trick: draw and rotate if needed
                        // But to make it work, let's assume portrait phone photos need 90Â° rotation if wrong

                        // Final fix: draw image, then rotate canvas if width/height mismatch expected
                        // But to make it robust, we can always draw and let pdf-lib handle, but since issue is known, add rotation

                        // Let's implement a basic orientation correction
                        // Common phone portrait: EXIF 6 = rotate 90Â° CW
                        // We can rotate the canvas 90Â° CW if image looks landscape but should be portrait

                        // Simple check: if original file name has 'IMG' or something, but better: always try to fix portrait
                        // Better way: draw image normally, but if aspect ratio is portrait but canvas is landscape, rotate

                        if (img.height > img.width) { // expected portrait
                            // If canvas is landscape, rotate 90Â°
                            if (canvas.width > canvas.height) {
                                const rotatedCanvas = document.createElement('canvas');
                                rotatedCanvas.width = canvas.height;
                                rotatedCanvas.height = canvas.width;
                                const rotatedCtx = rotatedCanvas.getContext('2d');
                                rotatedCtx.translate(rotatedCanvas.width / 2, rotatedCanvas.height / 2);
                                rotatedCtx.rotate(90 * Math.PI / 180);
                                rotatedCtx.drawImage(canvas, -canvas.width / 2, -canvas.height / 2);
                                resolve(rotatedCanvas);
                                return;
                            }
                        }

                        resolve(canvas);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileOverlay = document.getElementById('mobileOverlay');
        const sidebar = document.getElementById('sidebar');
      
        let isSidebarOpen = false;
      
        mobileMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleSidebar();
        });
      
        mobileOverlay.addEventListener('click', function(e) {
            e.stopPropagation();
            closeSidebar();
        });
      
        function toggleSidebar() {
            if (window.innerWidth <= 992) {
                if (!isSidebarOpen) {
                    sidebar.classList.add('show');
                    mobileOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    isSidebarOpen = true;
                } else {
                    closeSidebar();
                }
            }
        }
      
        function closeSidebar() {
            sidebar.classList.remove('show');
            mobileOverlay.classList.remove('active');
            document.body.style.overflow = 'auto';
            isSidebarOpen = false;
        }
      
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                if (window.innerWidth <= 992) closeSidebar();
            });
        });

        function showHowToUse() {
            document.getElementById('how-to-popup').style.display = 'flex';
        }

        function closeHowToUse() {
            document.getElementById('how-to-popup').style.display = 'none';
        }

        document.getElementById('how-to-popup')?.addEventListener('click', function(e) {
            if (e.target === this) closeHowToUse();
        });

        async function handleFiles(files) {
            if (files.length === 0) return;
          
            const file = files[0];
            if (file.type !== 'application/pdf') {
                alert("Please upload a PDF file!");
                return;
            }
          
            document.getElementById('upload-zone').style.display = 'none';
            document.getElementById('process-btn').style.display = 'block';
          
            setTimeout(() => {
                document.getElementById('process-btn').scrollIntoView({behavior: 'smooth', block: 'nearest'});
            }, 300);
          
            currentPDF = file;
            originalPDFData = await file.arrayBuffer();
          
            const pdf = await pdfjsLib.getDocument({data: originalPDFData}).promise;
            currentPages = [];
            document.getElementById('page-grid').innerHTML = '';
          
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const vp = page.getViewport({scale: 0.15});
                const canvas = document.createElement('canvas');
                canvas.height = vp.height; canvas.width = vp.width;
                await page.render({canvasContext: canvas.getContext('2d'), viewport: vp}).promise;
                addThumb(canvas.toDataURL(), file, i-1, i, true);
            }
          
            setTimeout(initSortable, 100);
        }

        function addThumb(data, file, idx, pageNumber, isPDF) {
            const id = 'p' + Math.random().toString(36).substr(2, 9);
            const pageObj = {id, file, idx, pageNumber, isPDF, data};
            currentPages.push(pageObj);
          
            const div = document.createElement('div');
            div.className = 'page-item';
            div.dataset.id = id;
          
            div.innerHTML = `
                <div class="drag-handle"><i class="fas fa-grip-vertical"></i></div>
                <div class="page-number">${pageNumber}</div>
                <img src="${data}" alt="Page ${pageNumber}">
                <div class="page-ctrl">
                    <button class="c-btn btn-del" onclick="removeThumb('${id}', this)">
                        <i class="fas fa-trash"></i> Remove
                    </button>
                    <button class="c-btn btn-add" onclick="addMoreAtPosition('${id}')">
                        <i class="fas fa-plus"></i> Add More
                    </button>
                </div>`;
          
            document.getElementById('page-grid').appendChild(div);
        }

        function removeThumb(id, btn) {
            currentPages = currentPages.filter(p => p.id !== id);
            btn.parentElement.parentElement.remove();
          
            if (document.querySelectorAll('.page-item').length === 0) {
                document.getElementById('upload-zone').style.display = 'block';
                document.getElementById('process-btn').style.display = 'none';
                currentPDF = null;
                originalPDFData = null;
            }
          
            updatePageNumbers();
        }

        // Updated addMoreAtPosition with EXIF orientation correction
        async function addMoreAtPosition(insertAfterId) {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.multiple = true;
            fileInput.setAttribute('accept', 'image/jpeg,image/jpg,image/png,image/gif,image/bmp,image/webp');
            fileInput.removeAttribute('capture');
            fileInput.style.display = 'none';
          
            fileInput.onchange = async function(e) {
                const files = Array.from(e.target.files);
                if (files.length === 0) return;
              
                const insertIndex = currentPages.findIndex(p => p.id === insertAfterId);
              
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    if (!file.type.startsWith('image/')) {
                        alert(`Only image files allowed for Add More. "${file.name}" skipped.`);
                        continue;
                    }
                  
                    // Load image with orientation correction
                    const correctedCanvas = await loadImageWithOrientation(file);
                    const trimmedCanvas = trimImage(correctedCanvas);
                    const trimmedDataUrl = trimmedCanvas.toDataURL('image/png');
                  
                    const newId = 'p' + Math.random().toString(36).substr(2, 9);
                    const newPageObj = {
                        id: newId,
                        file: file,
                        idx: 0,
                        pageNumber: currentPages.length + 1,
                        isPDF: false,
                        data: trimmedDataUrl
                    };
                  
                    currentPages.splice(insertIndex + i + 1, 0, newPageObj);
                  
                    const div = document.createElement('div');
                    div.className = 'page-item';
                    div.dataset.id = newId;
                  
                    div.innerHTML = `
                        <div class="drag-handle"><i class="fas fa-grip-vertical"></i></div>
                        <div class="page-number">${currentPages.length}</div>
                        <img src="${trimmedDataUrl}" alt="Added Image">
                        <div class="page-ctrl">
                            <button class="c-btn btn-del" onclick="removeThumb('${newId}', this)">
                                <i class="fas fa-trash"></i> Remove
                            </button>
                            <button class="c-btn btn-add" onclick="addMoreAtPosition('${newId}')">
                                <i class="fas fa-plus"></i> Add More
                            </button>
                        </div>`;
                  
                    const refElem = document.querySelector(`[data-id="${insertAfterId}"]`);
                    if (refElem && refElem.nextSibling) {
                        refElem.parentNode.insertBefore(div, refElem.nextSibling);
                    } else {
                        document.getElementById('page-grid').appendChild(div);
                    }
                }
              
                initSortable();
                updatePageNumbers();
                fileInput.remove();
            };
          
            document.body.appendChild(fileInput);
            fileInput.click();
        }

        function updatePageNumbers() {
            const items = document.querySelectorAll('.page-item');
            items.forEach((item, idx) => {
                const num = item.querySelector('.page-number');
                if (num) num.textContent = idx + 1;
            });
        }

        function initSortable() {
            if (sortableInstance) sortableInstance.destroy();
          
            sortableInstance = new Sortable(document.getElementById('page-grid'), {
                animation: 150,
                ghostClass: 'sortable-ghost',
                chosenClass: 'sortable-chosen',
                dragClass: 'sortable-drag',
                handle: '.drag-handle',
                delay: 100,
                delayOnTouchOnly: true,
                touchStartThreshold: 5,
                scroll: true,
                scrollSensitivity: 30,
                scrollSpeed: 10,
                onStart: () => { document.body.style.overflow = 'hidden'; },
                onEnd: (evt) => {
                    document.body.style.overflow = 'auto';
                    const pageItems = Array.from(document.querySelectorAll('.page-item'));
                    const newPages = [];
                    pageItems.forEach(item => {
                        const id = item.dataset.id;
                        const obj = currentPages.find(p => p.id === id);
                        if (obj) newPages.push(obj);
                    });
                    currentPages = newPages;
                    updatePageNumbers();
                }
            });
        }

        function startNewTask() {
            currentPages = [];
            finalBlob = null;
            currentPDF = null;
            originalPDFData = null;
            document.getElementById('page-grid').innerHTML = '';
            document.getElementById('picker').value = '';
            document.getElementById('upload-zone').style.display = 'block';
            document.getElementById('process-btn').style.display = 'none';
            document.getElementById('loader').style.display = 'none';
            document.getElementById('preview-frame').style.display = 'none';
            document.getElementById('pdf-preview-container').style.display = 'none';
            document.getElementById('preview-frame').src = "about:blank";
            document.getElementById('success-btns').style.display = 'none';
            document.getElementById('status-label').innerText = "Status: Ready";
          
            document.documentElement.scrollTop = 0;
            document.body.scrollTop = 0;
            const content = document.querySelector('.content');
            if (content) content.scrollTop = 0;
            setTimeout(() => window.scrollTo({top: 0, behavior: 'smooth'}), 10);
        }

        // startWork function - no image rotation, orientation matched
        async function startWork() {
            document.getElementById('loader').style.display = 'block';
            document.getElementById('status-label').innerText = "Processing...";
          
            try {
                if (currentPages.length === 0) {
                    alert("Please upload files first!");
                    document.getElementById('loader').style.display = 'none';
                    return;
                }
              
                const pdf = await PDFLib.PDFDocument.create();
                const A4_PORTRAIT = [595, 842];
                const A4_LANDSCAPE = [842, 595];
              
                for (const ref of currentPages) {
                    if (ref.isPDF) {
                        const src = await PDFLib.PDFDocument.load(await ref.file.arrayBuffer());
                        let pageIndices = [ref.idx];
                        if (ref.file !== currentPDF) {
                            pageIndices = Array.from({length: src.getPageCount()}, (_, i) => i);
                        }
                        const copied = await pdf.copyPages(src, pageIndices);
                        copied.forEach(page => pdf.addPage(page));
                    } else {
                        const imgBytes = await ref.file.arrayBuffer();
                        let embeddedImg;
                      
                        if (ref.file.type === 'image/png') {
                            embeddedImg = await pdf.embedPng(imgBytes);
                        } else {
                            embeddedImg = await pdf.embedJpg(imgBytes);
                        }
                      
                        const imgWidth = embeddedImg.width;
                        const imgHeight = embeddedImg.height;
                        const isLandscape = imgWidth > imgHeight;
                      
                        const pageDims = isLandscape ? A4_LANDSCAPE : A4_PORTRAIT;
                        const page = pdf.addPage(pageDims);
                      
                        const pageWidth = pageDims[0];
                        const pageHeight = pageDims[1];
                      
                        const scale = Math.min(
                            pageWidth / imgWidth,
                            pageHeight / imgHeight
                        );
                      
                        const drawWidth = imgWidth * scale;
                        const drawHeight = imgHeight * scale;
                      
                        const x = (pageWidth - drawWidth) / 2;
                        const y = (pageHeight - drawHeight) / 2;
                      
                        page.drawImage(embeddedImg, {
                            x: x,
                            y: y,
                            width: drawWidth,
                            height: drawHeight
                        });
                    }
                }
              
                finalBlob = new Blob([await pdf.save()], {type: 'application/pdf'});
                renderFinal();
              
            } catch (error) {
                console.error("Processing Error:", error);
                document.getElementById('status-label').innerText = "Error: " + (error.message || "Unknown error");
                document.getElementById('loader').style.display = 'none';
                alert("Processing failed! Check console for details.");
            }
        }

        function renderFinal() {
            if (!finalBlob) return;
          
            const isMobile = window.innerWidth <= 768;
          
            if (isMobile) {
                document.getElementById('preview-frame').style.display = 'none';
                document.getElementById('pdf-preview-container').style.display = 'block';
            } else {
                const blobUrl = URL.createObjectURL(finalBlob);
                document.getElementById('preview-frame').src = blobUrl;
                document.getElementById('preview-frame').style.display = 'block';
                document.getElementById('pdf-preview-container').style.display = 'none';
            }
          
            document.getElementById('loader').style.display = 'none';
            document.getElementById('success-btns').style.display = 'block';
            document.getElementById('status-label').innerText = "Processing Complete!";
        }

        function downloadFile() {
            if (!finalBlob) return;
            const a = document.createElement('a');
            a.href = URL.createObjectURL(finalBlob);
            a.download = "organized_document.pdf";
            a.click();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const mainPicker = document.getElementById('picker');
            if (mainPicker) {
                mainPicker.setAttribute('accept', '.pdf');
                mainPicker.removeAttribute('capture');
            }
          
            const uploadZone = document.getElementById('upload-zone');
            if (uploadZone) {
                uploadZone.addEventListener('dragover', e => {
                    e.preventDefault();
                    uploadZone.style.borderColor = '#ff6b6b';
                    uploadZone.style.background = 'rgba(255,107,107,0.05)';
                });
                uploadZone.addEventListener('dragleave', e => {
                    e.preventDefault();
                    uploadZone.style.borderColor = 'var(--border)';
                    uploadZone.style.background = 'var(--card-bg)';
                });
                uploadZone.addEventListener('drop', e => {
                    e.preventDefault();
                    uploadZone.style.borderColor = 'var(--border)';
                    uploadZone.style.background = 'var(--card-bg)';
                    if (e.dataTransfer.files.length) {
                        handleFiles([e.dataTransfer.files[0]]);
                    }
                });
            }
        });
    </script>
</body>
</html>